
<html>
	<head>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-1XTFM65VS2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-1XTFM65VS2');
</script>
	<meta charset=“UTF-8”>

		<link href="https://fonts.googleapis.com/css?family=Montserrat:300,400,500,600" rel="stylesheet">
		<link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Open+Sans:400,bold,900,600">
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/css/bootstrap.min.css">
		  <!-- Custom styles for this template -->
 		 <link href="css/custom.css" rel="stylesheet">

	  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script>
 	 <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/js/bootstrap.min.js"></script>

		<title>HE-diffusion</title>
	</head>
	<body>
		<div class = "global_container">
			<div class = "section"  >

				<h1>HE-Diffusion: Privacy-Preserving Diffusion Model using Homomorphic Encryption</h1>
				<div class ="boxed">
					<p> we introduce a privacy-preserving stable diffusion framework leveraging homomorphic encryption, called HE-Diffusion, which
                        primarily focuses on protecting the denoising phase of the diffusion process. HE-Diffusion is a tailored encryption frame-
                        work specifically designed to align with the unique architecture of stable diffusion, ensuring both privacy and function-
                        ality. To address the inherent computational challenges, we propose a novel min-distortion method that enables efficient
                        partial image encryption, significantly reducing the overhead without compromising the model’s output quality. Furthermore,
                        we adopt a sparse tensor representation to expedite computational operations, enhancing the overall efficiency of the 
                        privacy-preserving diffusion process. We successfully implement the HE-based private preserving stable diffusion inference.
                        The experimental results show that HE-Diffusion achieves 500 times speedup compared with the baseline method, and reduces
                        time cost of the homomorphically encrypted inference to the minute level.  Both the performance and accuracy of the 
                        HE-Diffusion are on par with the plaintext counterpart. Our approach marks a significant step towards integrating advanced
                        cryptographic techniques with state-of-the-art generative models, paving the way for privacy-preserving and efficient image
                        generation in critical applications.
					</p>
					<p style="font-size:20px"><a href="https://arxiv.org/pdf/2403.05794.pdf">Read the Paper</a>
					<a href="#bibtex" data-toggle="collapse" role="button">
					Cite <i class="fa fa-quote-right" aria-hidden="true"></i></a>
						<div id="bibtex" style="margin-top: 1.5em;" class="collapse" align="left">
							<pre style="white-space: pre">
                            @misc{chen2024privacypreserving,
                                title={Privacy-Preserving Diffusion Model Using Homomorphic Encryption},
                                author={Yaojian Chen and Qiben Yan},
                                year={2024},
                                eprint={2403.05794},
                                archivePrefix={arXiv},
                                primaryClass={cs.CR}
                            }
</pre></div>
</p>
				</div>


				<h1> Team </h1>
					<div class ="boxed" style="margin-top=3em;">
						<p>
							HE-diffusion was discovered by the following team of academic researchers:
						</p>
						<ul>
							<li><a href=""><strong>Yaojian Chen</strong></a> at <a href="http://seit.egr.msu.edu/">SEIT Lab</a>, <a href="https://www.cse.msu.edu/">Michigan State University</a></li>
					<li>
						<strong><a href="http://cse.msu.edu/~qyan/">Qiben Yan</a></strong> at <a href="http://seit.egr.msu.edu/">SEIT Lab</a>, <a href="https://www.cse.msu.edu/">Michigan State University</a></li>
						</ul>
<p class="text-center"><strong>Contact us at <a href="mailto:chenyaojian17@gmail.com">chenyaojian17@gmail.com</a>, <a href="mailto:qyan@msu.edu">qyan@msu.edu</a></strong></p>

 <div class="text-center mt-auto" style="width:100%;margin-top: 1.5em; margin-bottom: 1.5em; display:flex;justify-content:space-around;align-items:center; flex-wrap: wrap;">
      <div>
      <a href="https://www.cse.msu.edu/">
        <img width = "160px" src="logos/MSU-logo.png" alt="Michigan State University logo" class="img-fluid" />
				<div style = "height:10px"></div>
      </a>
      </div>
			<a href="https://www.cs.tsinghua.edu.cn">
        <img width="160px" src="logos/THU.jpeg" alt="THU logo" class="img-fluid" />
			</a>
 </div>
</div>


				<h1>Features</h1>

					<ul>
						<li class="question">
							<!--<li>
								<b> What's the difference between <a href="papers/p103-zhangAemb.pdf">dolphinAttack</a> and <a href="https://lightcommands.com/">lightcommands?</a></b>

									<li class="answer">    <b><font color="red">Long distance attack</font> with NLOS situation compares to dolphinAttack</b> It achieves longer than 30ft distance with certain materials</li>
									<li class="answer">    <b>None Line of sight attack.</b> It uses multiple solid media to attack victims.</li>
									<li class="answer">    <b>Attack multiple phones simultanously.</b> It can attack more than one phones in a same time.</li>

							</li>
							<br>
							<br>
							<br>-->
							<b> Why is privacy-preserving stable diffusion inference important?</b>

								<p class="answer">
									In the senario of AI as a service (AIaaS), tasks like texts to images will be applied by majority of users. However, high complexity prevent users from local computation. 
									The input prompts and the output images may contains users private information, which makes significant risks in hosting computing done on untrusted servers.
									Privacy-preserving stable diffusion inference aims to protect privace data while utilizing the computation resources of servers.
												</p>
							<b> How does HE-diffusion work?</b>

								<p class="answer">
									HE-diffusion applied homomorphic encryption to protect sensitive data. For inputs, users should encode the prompts and do several layers
									of the model forward. Homomorphic encryption works during denoising to protect outputs. Users can achieve privacy-preserving computation on servers by HE-diffusion.
									
												</p>
							<b> Will the generation ability be reduced due to privacy protection? </b>
								<p class="answer">
								HE-diffusion can generate images with ignorable loss compared with original stable diffusion. The only approximation happens at the encryption step due to the property of CKKS encryption scheme.
								In the whole computation process, we only do optimizations which do not change the results and precision.
													
																</p>
							
							
							<img width="800px" height="270px" src="figures/enc_acc.png" alt="" class="img-fluid">
							<p> Results from stable diffusion and HE-diffusion</p>
							<b> Can HE-diffusion inference be as fast as stable diffusion? </b>
								<p class="answer">
								HE-diffusion has a similar performance with the original stable diffusion. Homomorphic encryption works during denoising, where the computation is not that heavy.
								Furthermore, we utilized a series of optimizations including partial encryption. Finally, the inference times of HE-diffusion and stable diffusion are at the same order of magnitude.
													
																</p>
					<table>
  				<tr>
    			  <th>Case</th>
    			  <th>Plain</th>
  				  <th>Enc</th>
				  <th>Enc_opt</th>
				  <th>Sparse</th>
  				</tr>

					<tr>
    				<td>Denoise once</td>
    				<td>0.12s</td>
    				<td>354.34s</td>
					<td>1.67s</td>
					<td><strong>0.70s</strong></td>
  				</tr>

					<tr>
    				<td>Inference (CPU)</td>
    				<td>0.24h</td>
    				<td>10.06h</td>
					<td>0.41h</td>
					<td><strong>0.32h</strong></td>
  				</tr>

					<tr>
    				<td>Inference (GPU)</td>
    				<td>35s</td>
					<td>9.84h</td>
					<td>203s</td>
					<td><strong>106s</strong></td>
  				</tr>
</table><br>
					</ul>
	</body>
</html>
